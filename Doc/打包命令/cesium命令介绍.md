# ğŸ“šcesiumå‘½ä»¤æ€»ç»“

## ğŸ“– å¸¸ç”¨å‘½ä»¤

<img src="æ‰“åŒ…å‘½ä»¤.png"  width="80%" hight="80%"/>

### npm run start

è¿™ä¸ªå‘½ä»¤æ˜¯å¯åŠ¨Cesiumè‡ªå·±å†™çš„ä¸€ä¸ªhttpæœåŠ¡ï¼Œè™½ç„¶ä¸æ˜¯æ‰“åŒ…å‘½ä»¤ï¼Œä½†æ˜¯æ¯”è¾ƒå…¸å‹ï¼Œè¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹ã€‚  æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ä»¥åï¼Œå°±å¯ä»¥å¯åŠ¨æœåŠ¡äº†ï¼Œç«¯å£å·å¼ºåˆ¶ä¸º8080ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¾“å…¥localhost:8080ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š

<img src="startç•Œé¢.png"  width="80%" hight="80%"/>

**æ³¨æ„ç‚¹1ï¼š** å¦‚æœè¿™ä¸ªç«¯å£å·è¢«å ç”¨ï¼Œé‚£ä¹ˆå¯¹ä¸èµ·ï¼ŒæœåŠ¡èµ·ä¸æ¥ã€‚æ²¡æœ‰webpacké‚£ä¹ˆæœºæ™ºï¼Œä¸ä¼šè‡ªåŠ¨æ›¿æ¢ä¸€ä¸ªç«¯å£å·ã€‚

æ‰€ä»¥æœ‰æ—¶å€™ï¼Œå¦‚æœçœŸçš„ä¸æƒ³åœæ­¢ç°æœ‰çš„8080ç«¯å£æœåŠ¡ã€‚å¯ä»¥æ‰‹åŠ¨æ¢ä¸ªç«¯å£å·è¿è¡Œï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š

```
node server.js --port 8081
```

**æ³¨æ„ç‚¹2ï¼š** å¦å¤–è¿˜æœ‰ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„é—®é¢˜ï¼ŒCesiumçš„npm startå‘½ä»¤å¯åŠ¨çš„æœåŠ¡ï¼Œ **åªèƒ½åœ¨æœ¬æœºæŸ¥çœ‹** ï¼Œå¦‚æœæƒ³åœ¨å±€åŸŸç½‘å†…å…¶ä»–æœºå™¨ä¸Šè§‚çœ‹ï¼Œæ˜¯ä¸è¡Œçš„ã€‚å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æå®šï¼š

```
npm run startPublic
```

æ³¨æ„ï¼Œå¿…é¡»è¦åŠ ä¸Š **run** ï¼Œå¦åˆ™è¿˜æ˜¯è·‘ä¸èµ·æ¥çš„ã€‚

### npm run build

Cesiumçš„npm run buildå‘½ä»¤ï¼Œå’Œå…¶ä»–ä¸€äº›å¼€æºåº“ï¼ŒçœŸçš„æ˜¯æœ‰ç‚¹å„¿å·®åˆ«ã€‚å¤§éƒ¨åˆ†é¡¹ç›®æ‰§è¡Œè¿™ä¸ªå‘½ä»¤çš„æ„æ€ï¼Œä¸€èˆ¬éƒ½æ˜¯æ‰“åŒ…ç”Ÿæˆä¸€ä¸ªdistæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”æŠŠç¼–è¯‘å‹ç¼©ä¼˜åŒ–ï¼ˆç”Ÿäº§ç¯å¢ƒä¸‹ï¼‰çš„jsæ”¾è¿›å»ã€‚ä½†æ˜¯Cesiumå´æ˜¯åœ¨Sourceç›®å½•ä¸‹ç”Ÿæˆäº†ä¸€ä¸ªCesium.jsæ–‡ä»¶ï¼Œæ³¨æ„æ‚¨æ²¡çœ‹é”™ï¼Œæ˜¯ **Source** æ–‡ä»¶å¤¹ä¸‹ã€‚å½“ç„¶ä¹Ÿå·å·åšäº†ç‚¹åˆ«çš„äº‹æƒ…ï¼Œæš‚ä¸”ä¸è¡¨ã€‚

> buildå‘½ä»¤æ‰§è¡Œçš„æ“ä½œï¼š
> 1ã€åœ¨Sourceç›®å½•ä¸‹ç”Ÿæˆäº†ä¸€ä¸ªCesium.jsæ–‡ä»¶
>
> 2ã€å°†Source/Shaderä¸‹çš„glslæ–‡ä»¶è½¬ä¸ºjsæ–‡ä»¶ï¼ˆå¦‚æœä¸build åˆ™startä¸­çš„ç¤ºä¾‹æ— æ³•è¿è¡Œï¼‰
>
> 3ã€åœ¨APP/Sandcastleä¸‹æ‰«ægalleryå†…çš„ç¤ºä¾‹æ–‡ä»¶ï¼Œå¹¶ç”Ÿæˆç¤ºä¾‹ç´¢å¼•gallery-index.js,ç”¨äºåœ¨startå‘½ä»¤é¡µçš„Sandcastleï¼Œç»„ç»‡æ²™ç›’ç¤ºä¾‹ï¼Œåœ¨æ§åˆ¶å°ä¸­è°ƒè¯•ã€‚

![](https://upload-images.jianshu.io/upload_images/80648-df17ddbd8d58af36.png)

è¾“å…¥å›¾ç‰‡è¯´æ˜

é‡è¦çš„äº‹æƒ…å†è¯´ä¸€éï¼šSourceæ–‡ä»¶å¤¹ä¸‹çš„è¿™ä¸ªCesium.jsæ–‡ä»¶ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯æ²¡æœ‰çš„ï¼Œå¹¶ä¸æ˜¯æºç æ–‡ä»¶ï¼Œæ˜¯è¿è¡Œ`npm run build`å‘½ä»¤æ„å»ºå‡ºæ¥çš„jsæ–‡ä»¶ã€‚

å¥‡æ€ªäº†ï¼ŒCesiumæ‰“åŒ…çš„ç»“æœï¼Œä¸ºä»€ä¹ˆè¦æ”¾åœ¨Sourceæ–‡ä»¶å¤¹ä¸‹ï¼Ÿ

å…¶å®è¿™é‡Œçš„Cesium.jsæ–‡ä»¶å¹¶ä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šå¯¹å¤–è¾“å‡ºï¼ˆç”Ÿäº§ç¯å¢ƒä¸‹ï¼‰çš„jsæ–‡ä»¶ï¼Œä»…ä»…æ˜¯æŠŠCesiumæºç ä¸­ä¸€åƒä¸¤ç™¾å¤šä¸ªjsæ–‡ä»¶åšäº†ä¸€ä¸‹å¼•ç”¨ã€‚ã€‚æ‰€ä»¥è¿™ä¸ªCesium.jsä¹Ÿå°±ç›¸å½“äºä¸€ä¸ªç´¢å¼•ã€‚è¿™æ ·å¤–ç•Œä½¿ç”¨æ—¶ï¼Œåªè¦å¼•ç”¨è¿™ä¹ˆä¸€ä¸ªCesium.jsæ–‡ä»¶ï¼Œå°±ä¼šé€šè¿‡AMDæ¨¡å¼è‡ªåŠ¨å¼•å…¥å…¶ä»–Cesiumçš„æºç jsæ–‡ä»¶æ¥ä½¿ç”¨ã€‚

è¿™æ˜¯Cesiumæ‰“åŒ…æ—¶çš„ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„åœ°æ–¹ï¼ŒCesiumé€šè¿‡è¿™ç§æ–¹å¼ï¼Œå°±å¯ä»¥åœ¨ç½‘é¡µä¸­ç›´æ¥è°ƒè¯•æºç äº†ã€‚å¾ˆé—æ†¾ï¼ŒCesiumå¹¶æ²¡æœ‰ä½¿ç”¨ç›®å‰æ¯”è¾ƒæµè¡Œçš„SourceMapçš„æ–¹å¼ã€‚

é‚£ä¹ˆæ—¢ç„¶`npm run build`å‘½ä»¤å¹¶ä¸ä¼šè¿›è¡Œæ‰“åŒ…ï¼Œé‚£ä¹ˆçœŸæ­£çš„æ‰“åŒ…å‘½ä»¤æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¿™é‡Œå°±è¦è¯´åˆ°`npm run minifyRelease`å‘½ä»¤äº†ã€‚

### npm run minifyRelease

è¿™ä¸ªå‘½ä»¤ä¼šæŠŠSourceç›®å½•ä¸‹æ‰€æœ‰çš„jsæ–‡ä»¶æ‰“åŒ…æ”¾åˆ°Build/Cesium/ç›®å½•ä¸‹ï¼Œå¹¶ä¸”ç”Ÿæˆä¸€ä¸ªçœŸæ­£çš„ä¾›ç”Ÿäº§ç¯å¢ƒä¸‹æ¥ä½¿ç”¨çš„Cesium.jsæ–‡ä»¶ã€‚å› ä¸ºæ‰§è¡Œäº†å„ç§ç¼–è¯‘å‹ç¼©æ‰“åŒ…ç­‰æ“ä½œï¼Œæ‰€ä»¥ç¼–è¯‘é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œåœ¨æˆ‘çš„æœºå™¨ä¸Šï¼Œå¤§æ¦‚éœ€è¦2åˆ†é’Ÿæ‰èƒ½ç¼–è¯‘å®Œã€‚ã€‚

![](https://upload-images.jianshu.io/upload_images/80648-a902122363883575.png)

è¾“å…¥å›¾ç‰‡è¯´æ˜

æˆ‘ä»¬å†æ¥åˆ†æä¸€ä¸‹è¿™ä¸ªå‘½ä»¤çš„æ“ä½œï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://upload-images.jianshu.io/upload_images/80648-2ab48a5918d04dc0.png)

è¾“å…¥å›¾ç‰‡è¯´æ˜

`outputDirectory`é€‰é¡¹ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒCesiumæŠŠå‹ç¼©ä¼˜åŒ–åçš„Cesium.jsæ–‡ä»¶æ”¾åœ¨äº†Build/Cesium/ç›®å½•ä¸‹ã€‚

`optimizer`é€‰é¡¹åˆ™è¡¨ç¤ºjsä»£ç å¦‚ä½•å‹ç¼©ä¼˜åŒ–ï¼ŒCesiumä½¿ç”¨çš„æ˜¯uglify2ã€‚

`removePragmas`é€‰é¡¹æ˜¯ç”¨æ¥åˆ é™¤æºç ä¸­çš„è°ƒè¯•ä¿¡æ¯çš„ã€‚æˆ‘ä»¬æŸ¥çœ‹Cesiumæºç æ—¶ï¼Œæœ‰æ—¶ä¼šå‘ç°æºç ä¸­æœ‰å¤§é‡çš„`includeStart`å¼€å¤´çš„æ³¨é‡Šï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚è¿™é‡Œé¢å¤§å¤šæ˜¯è°ƒè¯•ä¿¡æ¯ï¼ŒremovePragmasè®¾ç½®ä¸ºtrueï¼Œç›¸å½“äºæ¥åˆ é™¤`includeStart`å’Œ`includeEnd`ä¹‹é—´çš„jsè¯­å¥ã€‚

![](https://upload-images.jianshu.io/upload_images/80648-433e1444672f4632.png)

è¾“å…¥å›¾ç‰‡è¯´æ˜

### npm run minify

`npm run minify`å‘½ä»¤çš„é…ç½®å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°ä»–ä¼šå‹ç¼©ä¼˜åŒ–jsä»£ç ï¼Œä½†æ˜¯ä¸ä¼šå»æ‰è°ƒè¯•ä¿¡æ¯ã€‚

![](https://upload-images.jianshu.io/upload_images/80648-db19cee405b87e87.png)

è¾“å…¥å›¾ç‰‡è¯´æ˜

### npm run combine

`npm run combine`å‘½ä»¤åˆ™æ˜¯æ—¢ä¸å‹ç¼©ä¼˜åŒ–ï¼Œä¹Ÿä¸å»æ‰è°ƒè¯•ä¿¡æ¯ã€‚ç›¸å½“äºç”Ÿæˆå…·å¤‡è°ƒè¯•ä¿¡æ¯çš„jsæ–‡ä»¶ã€‚

> æ³¨é‡Šï¼šå½“å‰1.78ç‰ˆæœ¬ï¼Œæ”¯æŒsourcemap

![](https://upload-images.jianshu.io/upload_images/80648-0a9fbed9db7d5343.png)

è¾“å…¥å›¾ç‰‡è¯´æ˜

### npm run combineRelease

`npm run combineRelease`å‘½ä»¤ç›¸å½“äºä¸è¿›è¡Œå‹ç¼©ä¼˜åŒ–ï¼Œä½†æ˜¯å»æ‰äº†è°ƒè¯•ä¿¡æ¯ã€‚

![](https://upload-images.jianshu.io/upload_images/80648-ee3d37eba3005a57.png)

è¾“å…¥å›¾ç‰‡è¯´æ˜

### npm run release

`npm run release`å‘½ä»¤åˆ™ç›¸å½“äºcombineã€minifyReleaseã€generateDocumentationä¸‰ä¸ªå‘½ä»¤çš„é›†åˆã€‚ä»–ä¼šåŒæ—¶åšäº†ä¸‰ä»¶äº‹ï¼š

1. åœ¨Build/CesiumUnminifiedç›®å½•ä¸‹ç”Ÿæˆè°ƒè¯•ç‰ˆçš„Cesium.jsæ–‡ä»¶ï¼›
2. åœ¨Build/Cesiumç›®å½•ä¸‹ç”Ÿæˆå‹ç¼©ä¼˜åŒ–å¥½çš„(ç”Ÿäº§ç¯å¢ƒä¸‹ï¼‰çš„Cesium.jsæ–‡ä»¶ï¼›
3. å¹¶ä¸”è¿˜ç”Ÿæˆäº†Cesiumçš„apiæ–‡æ¡£ï¼Œæ–‡æ¡£æ”¾åœ¨Build/Documentationç›®å½•ä¸‹ã€‚

![](https://upload-images.jianshu.io/upload_images/80648-6e79535e697fb21a.png)

è¾“å…¥å›¾ç‰‡è¯´æ˜

### npm run buildApps

`npm run buildApps`åšäº†2ä»¶äº‹ï¼š

* åœ¨Build/Appsç›®å½•ä¸‹ç”Ÿæˆæ„å»ºç‰ˆçš„CesiumViewerï¼ˆstartç•Œé¢ä¸­çš„built version)ï¼›
* åœ¨Build/Appsç›®å½•ä¸‹ç”Ÿæˆæ„å»ºç‰ˆçš„Sandcastleï¼ˆstartç•Œé¢ä¸­çš„built version)ï¼›

`npm run buildApps`è¿è¡ŒæˆåŠŸçš„å‰ææ˜¯æå‰åœ¨Buildç›®å½•ä¸‹æ”¾ç½®æ„å»ºå¥½çš„Cesiumæ–‡ä»¶å¤¹ï¼Œå³å…ˆæ‰§è¡Œ`npm run minifyRelease`æˆ–è€…`npm run minify`å‘½ä»¤ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚å› ä¸ºBuild/Appsè°ƒè¯•å°å¼•ç”¨çš„Build/Ceiusmä¸‹çš„Cesium.jsï¼Œè€ŒåŸæ¥/Appsä¸‹çš„è°ƒè¯•å°å¼•ç”¨çš„Source/ä¸‹çš„Cesium.jsã€‚å¦‚æœæ²¡æœ‰è‡ªå®šä¹‰æ„å»ºçš„Cesiumæ–‡ä»¶å¤¹ï¼Œå¯å°†`npm run combineRelease`æˆ–è€…`npm run combine`çš„å†…å®¹å…¨éƒ¨æ‹·è´è‡³Build/Ceiusmä¸‹ã€‚


### æ‰“åŒ…é—ç•™é—®é¢˜

#### çœ‹ä¸åˆ°Developmentåˆ†ç»„

å¾ˆå¤šåŒå­¦ä¼šåé¦ˆCesiumçš„ç¤ºä¾‹ä»£ç ä¸­æœ‰çš„æ—¶å€™çœ‹ä¸åˆ°Developmentåˆ†ç»„ã€‚

![](https://upload-images.jianshu.io/upload_images/80648-ffdeac58a963a5a8.png)

è¾“å…¥å›¾ç‰‡è¯´æ˜

è¿™ä¸»è¦æ˜¯å› ä¸º`npm run build`å’Œ`npm run release`å‘½ä»¤éƒ½ä¼šç”ŸæˆApps/Sandcastle/gallery/gallery-index.jsæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ç”¨æ¥ç®¡ç†Cesiumçš„ç¤ºä¾‹ç›®å½•çš„ã€‚ç„¶è€Œåè€…ç”Ÿæˆçš„gallery-index.jsæ–‡ä»¶ä¼šå»æ‰developåˆ†ç»„ã€‚æ‰€ä»¥å®é™…æƒ…å†µæ˜¯ï¼Œæ‰§è¡Œäº†`npm run release`å‘½ä»¤ä»¥åï¼ŒDevelopmentåˆ†ç»„å°±ä¼šæ¶ˆå¤±ã€‚å¦‚æœå¸Œæœ›å†æ¬¡çœ‹åˆ°ï¼Œæ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯å†æ¬¡æ‰§è¡Œä¸€ä¸‹`npm run build`å‘½ä»¤å³å¯ã€‚

#### ç¼–è¯‘åŒ…å’Œæºç åŒ…çš„åŒºåˆ«

Cesiumå®˜æ–¹åœ¨githubä¸­ä¼šåŒæ—¶æä¾›ä¸¤ä¸ªç‰ˆæœ¬çš„zipåŒ…ï¼Œå¤´ä¸€ä¸ªæ˜¯Cesiumäº‹å…ˆæ‰“åŒ…ç¼–è¯‘å¥½çš„ï¼Œè¿™ä¸ªzipåŒ…é‡Œé¢ä¼šæœ‰Buildç›®å½•ã€‚åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­ç›´æ¥æ‹¿æ¥å¼•ç”¨Build/Cesium/Cesium.jså°±å¥½ã€‚ä½†æ˜¯æ‚¨åœ¨è¿™ä¸ªzipåŒ…é‡Œé¢æ˜¯çœ‹ä¸åˆ°Cesiumç¤ºä¾‹ä¸­çš„developmentåˆ†ç»„çš„ï¼Œè€Œä¸”ä¹Ÿä¸èƒ½æ‰§è¡Œ`npm run build`è¿›è¡Œç¼–è¯‘ï¼ˆéƒ¨åˆ†ç¼–è¯‘æ–‡ä»¶è¢«ç§»é™¤ï¼‰ã€‚

å¦‚æœå¸Œæœ›çœ‹åˆ°developmentåˆ†ç»„ç¤ºä¾‹ï¼Œæˆ–è€…ä¿®æ”¹Cesiumæºç çš„è¯ï¼Œå°±åªèƒ½ç”¨ç¬¬äºŒä¸ªzipåŒ…äº†ã€‚è¿™ä¸ªzipåŒ…é‡Œé¢åªæœ‰æºç ï¼Œéœ€è¦è‡ªè¡Œæ‰“åŒ…ã€‚

![](https://upload-images.jianshu.io/upload_images/80648-bf4c477d78cd4271.png)

è¾“å…¥å›¾ç‰‡è¯´æ˜

### æ€»ç»“

1. npm run build åªæ˜¯ç”Ÿæˆäº†ä¸€ä¸ªSourceç›®å½•çš„Cesium.jsæ–‡ä»¶ï¼Œç›¸å½“äºä¸€ä¸ªç´¢å¼•ï¼›
2. npm run minifyRelease æ‰æ˜¯çœŸæ­£ç”¨æ¥è¾“å‡ºç”Ÿäº§ç¯å¢ƒä¸‹çš„Cesium.jsæ–‡ä»¶ï¼Œè¾“å‡ºç›®å½•åœ¨Build/Cesium/ä¸‹ï¼›
3. npm run release åŒæ—¶è¾“å‡ºè°ƒè¯•ç‰ˆçš„Cesium.jsã€ç”Ÿäº§ç¯å¢ƒä¸‹çš„Cesium.jså’Œapiæ–‡æ¡£ã€‚
